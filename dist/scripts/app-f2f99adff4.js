!function(){"use strict";angular.module("OMDBApp",["ui.router","ngCookies","ui.bootstrap","pascalprecht.translate","translations","angular-loading-bar","ngAnimate","ngdexie","ngdexie.ui","infinite-scroll"])}(),function(){"use strict";function t(t,e,a){function n(){var t={};for(var e in r.searchData)r.searchData[e]&&(t[e.toLowerCase()]=r.searchData[e]);a.search(t)}t.info("SearchForm Component initialized on date: %s",(new Date).toISOString());var r=this;r.onChangeSearchData=n}t.$inject=["$log","_","$location"],angular.module("OMDBApp").component("searchForm",{templateUrl:"app/components/search-form/search-form.html",controller:t,controllerAs:"search_form_vm",bindings:{list:"=",searchData:"=",doSearch:"="}})}(),function(){"use strict";function t(t,e){function a(){n.list=e.reverse(e.sortBy(n.list,function(t){return t[n.orderBy]}))}t.info("OrderList Component initialized on date: %s",(new Date).toISOString());var n=this;n.doOrderBy=a}t.$inject=["$log","_"],angular.module("OMDBApp").component("orderList",{templateUrl:"app/components/order-list/order-list.html",controller:t,controllerAs:"order_list_vm",bindings:{list:"="}})}(),function(){"use strict";function t(t){return{templateUrl:"app/components/navbar-top/navbar-top.html",link:e(t),controller:a,controllerAs:"navbar_top_vm"}}function e(t){return function(e,a){var n=t.location.href.substr(t.location.href.lastIndexOf("/")+1),r=angular.element(a);r.find(".navbar-nav li").click(function(){angular.element(this).addClass("active"),angular.element(this).parent().children("li").not(this).removeClass("active")}),r.find(".navbar-nav li a").each(function(){var t=angular.element(this);t.attr("href").indexOf(n)>0&&(t.parent().parent().children("li").removeClass("active"),t.parent().addClass("active"))})}}function a(t,e,a,n,r){function o(t){return e.use(t),a.reload()}t.info("NavBarController initialized on date: %s",(new Date).toISOString());var i=this;i.avaliableLanguages=n,i.mapLanguageTranslationByKey=r,i.switchLanguage=o}t.$inject=["$window"],e.$inject=["$window"],a.$inject=["$log","$translate","$state","AVALIABLE_LANGUAGES","LANGUAGES_TRANSLATION_KEYS"],angular.module("OMDBApp").directive("navbarTop",t)}(),function(){"use strict";function t(t,e){function a(t){return angular.isFunction(n.onScrolling)&&n.onScrolling(!0),e.go("layout.detail",{imdbID:t.imdbID,slug:t.Title})}t.info("ListView Component initialized on date: %s",(new Date).toISOString());var n=this;n.getMoreInformation=a}t.$inject=["$log","$state"],angular.module("OMDBApp").component("listView",{templateUrl:"app/components/list-view/list-view.html",controller:t,controllerAs:"list_view_vm",bindings:{list:"=",onScrolling:"=",searchData:"="}})}(),function(){"use strict";function t(t){t.info("LayoutAbstractController initialized on date: %s",(new Date).toISOString())}t.$inject=["$log"],angular.module("OMDBApp").controller("LayoutAbstractController",t)}(),function(){"use strict";function t(t,e,a,n){function r(t,e){if(!t.Response||!angular.isArray(t.Search))return e(null,[]);var r=[],i=[];return t.Search.map(function(t){return i.push(function(e){return o(t.imdbID,function(t,a){return t?e(t):("N/A"===a.Poster&&(a.Poster=n),a&&r.push(a),e(null))})})}),a.parallel(i,function(t){return t?e(t):e(null,r)})}function o(a,n){return e.searchByImdbId(a).then(function(e){return t.info("Response by imdbId [%s]",a,e),n(null,e.data)})["catch"](function(e){return t.error(e,"Error when get result by imdbId"),n(e,null)})}function i(a,n){return e.advancedFilter(a).then(function(e){return t.info("Response list of search",e),r(e.data,function(t,e){return n(t,e)})})["catch"](function(e){return t.error(e,"Error when get list of search"),n(e,null)})}return t.info("HomeService initialized on date: %s",(new Date).toISOString()),{doSearch:i,searchByImdbId:o}}t.$inject=["$log","WebAPI","async","FALLBACK_POSTER_IMG"],angular.module("OMDBApp").service("HomeService",t)}(),function(){"use strict";function t(t,e,a,n){function r(){var t={page:l.page};for(var e in l.searchData)l.searchData[e]&&(t[e.toLowerCase()]=l.searchData[e]);a.search(t)}function o(t){l.scrolling=t}function i(){return l.page++,l.scrolling=!0,s()}function s(){r();var t=n.extend(n.clone(l.searchData),{page:l.page});e.doSearch(t,function(t,e){t||(l.searchList=l.searchList.concat(e),l.scrolling=!e.length,e.length||(l.page--,r()))})}t.info("HomeController initialized on date: %s",(new Date).toISOString());var l=this;l.searchList=[],l.searchData={Title:a.search().title||"",Year:a.search().year||"",Genre:a.search().genre||""},l.page=a.search().page||1,l.scrolling=!1,l.doSearch=s,l.onScrollPage=i,l.onScrolling=o,function(){l.searchData.Title&&s()}()}t.$inject=["$log","HomeService","$location","_"],angular.module("OMDBApp").controller("HomeController",t)}(),function(){"use strict";function t(t,e,a){function n(t){var e=a.pick(t,["imdbID","Title","Poster","Year","imdbRating","Genre"]);return e.Genre=e.Genre.split(","),e}function r(a,r){var o=n(a);return e.add(c,o).then(function(){return t.info("Save favorite in IndexDB with success",o),r(null,o)})["catch"](function(e){return t.error("Error when save favorite in IndexDB",e),r(e,null)})}function o(a,n){return e.remove(c,a.imdbID).then(function(){return t.info("imdbID [%s] removed with success",a.imdbID),n(null,a)})["catch"](function(e){return e&&t.error("imdbID [%s] error when remove",a.imdbID,e),n(e||new Error("Register cannot be removed"),null)})}function i(a){return e.list(c).then(function(e){return t.info("Result list of favorites: ",e),a(null,e)})["catch"](function(e){return t.error("Error when return list of favorites: ",e),a(e||new Error("Cannot get the list of favorites"),null)})}function s(t,a){return e.getByIndex(c,t,a)}function l(e,a){return s("imdbID",e).then(function(e){return t.info("Successfully to get by imdbID",e),a(null,e)})["catch"](function(e){return e&&t.error("Error when get by imdbID",e),a(e||new Error("Register doest exist"),null)})}t.info("FavoriteService initialized on date: %s",(new Date).toISOString());var c="favorites";return{create:r,remove:o,select:i,getByImdbId:l}}t.$inject=["$log","ngDexie","_"],angular.module("OMDBApp").service("FavoriteService",t)}(),function(){"use strict";function t(t,e,a){function n(){e.select(function(t,e){t||(r.list=e)})}t.info("FavoriteController initialized on date: %s",(new Date).toISOString());var r=this;r.list=[],r.searchData={Title:a.search().title||"",Year:a.search().year||"",Genre:a.search().genre||""},function(){n()}()}t.$inject=["$log","FavoriteService","$location"],angular.module("OMDBApp").controller("FavoriteController",t)}(),function(){"use strict";function t(t,e){function a(a,n){return e.getDetailsByImdbId(a).then(function(e){return t.info("Response full info by imdbId [%s]",a,e),n(null,e.data)})["catch"](function(e){return t.error(e,"Error when get full info by imdbId"),n(e,null)})}function n(a,n){return e.getVideosByImdbId(a).then(function(e){return t.info("Response videos by imdbId [%s]",a,e),n(null,e.data)})["catch"](function(e){return t.error(e,"Error when get videos by imdbId"),n(e,null)})}return t.info("DetailService initialized on date: %s",(new Date).toISOString()),{getFullInfo:a,searchVideos:n}}t.$inject=["$log","WebAPI"],angular.module("OMDBApp").service("DetailService",t)}(),function(){"use strict";function t(t,e,a,n,r){function o(){return n.getFullInfo(c.imdbId,function(t,e){t||(c.result=e)})}function i(){r.getByImdbId(c.imdbId,function(t,e){return t||!e?c.actions.add=!0:void 0})}function s(t){return r.create(t,function(t,e){return t?void 0:c.actions.add=e?!1:!0})}function l(t){return r.remove(t,function(t,e){return t?void 0:c.actions.add=e?!0:!1})}t.info("DetailController initialized on date: %s",(new Date).toISOString());var c=this;c.createInFavoriteList=s,c.removeInFavoriteList=l,c.imdbId=a.imdbID,c.result=null,c.fieldsToShow=["Plot","Actors","Year","Genre","Director","imdbRating","Awards"],c.mapFieldsToTranslateKey={Plot:"DETAIL_LABEL_PLOT",Actors:"DETAIL_LABEL_ACTORS",Year:"DETAIL_LABEL_YEAR",Genre:"DETAIL_LABEL_GENRE",Director:"DETAIL_LABEL_DIRECTOR",imdbRating:"DETAIL_LABEL_RATING",Awards:"DETAIL_LABEL_AWARDS"},c.actions={add:!1},function(){e.search({}),o(),i()}()}t.$inject=["$log","$location","$stateParams","DetailService","FavoriteService"],angular.module("OMDBApp").controller("DetailController",t)}(),function(){"use strict";function t(t){return t._}function e(t){return t.async}t.$inject=["$window"],e.$inject=["$window"],angular.module("OMDBApp").service("_",t).service("async",e)}(),function(){"use strict";function t(t){t.info("App running on date: %s",(new Date).toISOString())}t.$inject=["$log"],angular.module("OMDBApp").run(t)}(),function(){"use strict";function t(t,e){t.state("layout",{"abstract":!0,templateUrl:"app/components/layout/layout.html",controller:"LayoutAbstractController",controllerAs:"layout_vm"}).state("layout.home",{url:"/",views:{layoutContent:{templateUrl:"app/components/home/home.html",controller:"HomeController",controllerAs:"home_vm"}}}).state("layout.detail",{url:"/:imdbID/:slug",views:{layoutContent:{templateUrl:"app/components/details/detail.html",controller:"DetailController",controllerAs:"detail_vm"}}}).state("layout.favorites",{url:"/favorites",views:{layoutContent:{templateUrl:"app/components/favorites/favorite.html",controller:"FavoriteController",controllerAs:"favorite_vm"}}}),e.otherwise("/")}t.$inject=["$stateProvider","$urlRouterProvider"],angular.module("OMDBApp").config(t)}(),function(){"use strict";function t(t){function e(t,e){}function a(t){}return function(){t.info("OfflineWebAPI running on date: %s",(new Date).toISOString())}(),{createMovie:e,selectMovie:a}}t.$inject=["$log"],angular.module("OMDBApp").service("OfflineWebAPI",t)}(),angular.module("OMDBApp").constant("OMDB_API_URL","https://omdbapi.com/").constant("MOVIEDB_API_URL","https://api.themoviedb.org/3/movie/").constant("MOVIEDB_API_KEY","c5faf8570229b9ae76311638b0557c56").constant("DATABASE_OPTIONS",{name:"omdb_database",debug:!1,version:1,stores:{movies:"++imdbID, data",favorites:"++imdbID, Title, Poster, Year, imdbRating, Genre"}}),function(){"use strict";function t(t,e){var a=angular.injector(["ng"]).get("$log");a.info("Database config init",e);var n={name:e.name,debug:e.debug};t.setOptions(n).setConfiguration(function(t){t.version(e.version).stores(e.stores),t.on("error",function(t){return a.error("Database connection error: ",t)}).on("ready",function(){return a.info("Database connection established")})})}t.$inject=["ngDexieProvider","DATABASE_OPTIONS"],angular.module("OMDBApp").config(t)}(),function(){"use strict";angular.module("OMDBApp").constant("DEFAULT_LANGUAGE",navigator.language||"en-US").constant("FALLBACK_POSTER_IMG","assets/images/default_poster.jpg").constant("AVALIABLE_LANGUAGES",["en","pt"]).constant("LANGUAGES_TRANSLATION_KEYS",{en:"NAVBAR_LANGUAGE_EN",pt:"NAVBAR_LANGUAGE_PT"})}(),function(){"use strict";function t(t,e,a){t.includeSpinner=!1;var n={"en_*":"en","en-*":"en","pt_*":"pt","pt-*":"pt","es_*":"es","es-*":"es"};e.useLocalStorage().useSanitizeValueStrategy("escape").registerAvailableLanguageKeys(["en","pt","es"],n).preferredLanguage(a).determinePreferredLanguage().fallbackLanguage(a)}t.$inject=["cfpLoadingBarProvider","$translateProvider","DEFAULT_LANGUAGE"],angular.module("OMDBApp").config(t)}(),function(){"use strict";function t(t,e,a,n,r,o){function i(t,e){var r=o.extend(e||{},{api_key:n}),i=angular.isArray(t)?t.join("/"):angular.isString(t)?t:"";return{url:a.concat(i),query:r}}function s(t){return t=o.extend(t,{plot:"full"}),r({method:"GET",url:e,params:t})}function l(t){var e={i:t};return s(e)}function c(t){var e={Title:"s",Year:"y",type:"type",page:"page"},a={};for(var n in t)e[n]&&t[n]&&(a[e[n]]=t[n]);return s(a)}function u(t){var e={i:t};return s(e)}function d(t){var e=i([t,"videos"]);return r({method:"GET",url:e.url,params:e.query})}return function(){t.info("WebAPI running on date: %s",(new Date).toISOString())}(),{searchByImdbId:l,advancedFilter:c,getDetailsByImdbId:u,getVideosByImdbId:d}}t.$inject=["$log","OMDB_API_URL","MOVIEDB_API_URL","MOVIEDB_API_KEY","$http","_"],angular.module("OMDBApp").service("WebAPI",t)}(),function(){"use strict";function t(t){t.translations("en",{DETAIL_LABEL_PLOT:"Plot",DETAIL_LABEL_ACTORS:"Actors",DETAIL_LABEL_YEAR:"Year",DETAIL_LABEL_GENRE:"Genre",DETAIL_LABEL_DIRECTOR:"Director",DETAIL_LABEL_RATING:"Rating",DETAIL_LABEL_AWARDS:"Awards",DETAIL_ALERT_ALREADY_ADDED_IN_FAVORITES_BODY:"Already added to favorites, you want to",DETAIL_ALERT_ALREADY_ADDED_IN_FAVORITES_BUTTON:"remove?"}),t.translations("pt",{DETAIL_LABEL_PLOT:"Enredo",DETAIL_LABEL_ACTORS:"Atores",DETAIL_LABEL_YEAR:"Ano",DETAIL_LABEL_GENRE:"Gênero",DETAIL_LABEL_DIRECTOR:"Diretor",DETAIL_LABEL_RATING:"Avaliação",DETAIL_LABEL_AWARDS:"Prêmios",DETAIL_ALERT_ALREADY_ADDED_IN_FAVORITES_BODY:"Já adicionado aos seus favoritos, você deseja",DETAIL_ALERT_ALREADY_ADDED_IN_FAVORITES_BUTTON:"remover?"}),t.translations("en",{LABEL_ADD_FAVORITES:"+ Favorite"}),t.translations("pt",{LABEL_ADD_FAVORITES:"+ Favoritos"}),t.translations("en",{}),t.translations("pt",{}),t.translations("en",{}),t.translations("pt",{}),t.translations("en",{LABEL_READ_MORE:"Read More"}),t.translations("pt",{LABEL_READ_MORE:"Leia mais"}),t.translations("en",{NAVBAR_TITLE_HOME:"Home",NAVBAR_TITLE_FAVORITES:"Favorites",NAVBAR_LANGUAGE_TITLE:"Language",NAVBAR_LANGUAGE_EN:"English",NAVBAR_LANGUAGE_PT:"Portuguese"}),t.translations("pt",{NAVBAR_TITLE_HOME:"Inicio",NAVBAR_TITLE_FAVORITES:"Favoritos",NAVBAR_LANGUAGE_TITLE:"Linguagem",NAVBAR_LANGUAGE_EN:"Inglês",NAVBAR_LANGUAGE_PT:"Português"}),t.translations("en",{ORDER_BY_LABEL:"Order by",ORDER_BY_YEAR:"Year",ORDER_BY_RATING:"Rating",ORDER_BY_GENRE:"Genre"}),t.translations("pt",{ORDER_BY_LABEL:"Ordenar por",ORDER_BY_YEAR:"Ano",ORDER_BY_RATING:"Avaliação",ORDER_BY_GENRE:"Gênero"}),t.translations("en",{FORM_INPUT_SEARCH_NAME_PLACEHOLDER:"Movie name",FORM_INPUT_SEARCH_YEAR_PLACEHOLDER:"Movie year",FORM_INPUT_SEARCH_GENRE_PLACEHOLDER:"Movie Genre",FORM_INPUT_SUBMIT:"Search"}),t.translations("pt",{FORM_INPUT_SEARCH_NAME_PLACEHOLDER:"Nome do filme",FORM_INPUT_SEARCH_YEAR_PLACEHOLDER:"Ano do filme",FORM_INPUT_SEARCH_GENRE_PLACEHOLDER:"Gênero do filme",FORM_INPUT_SUBMIT:"Procurar"})}t.$inject=["$translateProvider"],angular.module("translations",[]).config(t)}(),angular.module("OMDBApp").run(["$templateCache",function(t){t.put("app/components/details/detail.html",'<div class=container><div class="detail-container well" data-ng-if=detail_vm.result><div class=detail-header><h1 class=text-center>{{detail_vm.result.Title}} - {{detail_vm.result.Year}}</h1></div><div class=detail-body><div class="detail-poster text-center"><img data-ng-if=detail_vm.result.Poster data-ng-src={{detail_vm.result.Poster}} data-err-src=assets/images/default_poster.jpg alt={{detail_vm.result.Title}}></div><hr><div class=detail-item data-ng-repeat="field in detail_vm.fieldsToShow" data-ng-if=detail_vm.result[field]><strong>{{:: detail_vm.mapFieldsToTranslateKey[field] | translate}}: </strong>{{detail_vm.result[field]}}</div><div class="detail-actions text-center" data-ng-if=detail_vm.actions.add><button class="btn btn-primary" data-ng-bind=":: \'LABEL_ADD_FAVORITES\' | translate" data-ng-click=detail_vm.createInFavoriteList(detail_vm.result)>+ Favorites</button></div><div class="detail-actions text-center" data-ng-if=!detail_vm.actions.add><div class="alert alert-info">{{:: \'DETAIL_ALERT_ALREADY_ADDED_IN_FAVORITES_BODY\' | translate}} <a href class=text-danger data-ng-click=detail_vm.removeInFavoriteList(detail_vm.result)>{{:: \'DETAIL_ALERT_ALREADY_ADDED_IN_FAVORITES_BUTTON\' | translate}}</a></div></div></div></div></div>'),t.put("app/components/favorites/favorite.html","<search-form data-search-data=favorite_vm.searchData data-do-search=favorite_vm.doSearch data-list=favorite_vm.list></search-form><list-view data-list=favorite_vm.list data-search-data=favorite_vm.searchData></list-view>"),t.put("app/components/home/home.html",'<section class="container search-page"><search-form data-search-data=home_vm.searchData data-do-search=home_vm.doSearch data-list=home_vm.searchList></search-form><div class=search-result infinite-scroll=home_vm.onScrollPage() infinite-scroll-immediate-check=false infinite-scroll-distance=3 infinite-scroll-disabled=home_vm.scrolling infinite-scroll-use-document-bottom=true><list-view data-list=home_vm.searchList data-search-data=home_vm.searchData data-on-scrolling=home_vm.onScrolling></list-view></div></section>'),t.put("app/components/layout/layout.html","<navbar-top></navbar-top><section ui-view=layoutContent></section>"),t.put("app/components/list-view/list-view.html",'<div class="result-list text-center"><div class=row data-ng-repeat="result in list_view_vm.list | filter:list_view_vm.searchData:strict" data-ng-if=list_view_vm.list.length><div class="col-md-6 col-md-offset-3 well"><h4 class=result-title data-ng-if=result.Title>{{result.Title}}</h4><div class=result-poster><img data-ng-if=result.Poster data-ng-src={{result.Poster}} data-err-src=assets/images/default_poster.jpg alt={{result.Title}}></div><div class=result-actions><button class="btn btn-primary" data-ng-bind=":: \'LABEL_READ_MORE\' | translate" data-ng-click=list_view_vm.getMoreInformation(result)>See More</button></div></div></div></div>'),t.put("app/components/navbar-top/navbar-top.html",'<nav class="navbar navbar-inverse navbar-fixed-top"><div class=container-fluid><div class=navbar-header><button type=button class="navbar-toggle collapsed" data-toggle=collapse data-target=#navbar aria-expanded=false aria-controls=navbar><span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span></button> <a class=navbar-brand href=#><img src=assets/images/logo.png alt="" class=navbar-logo></a></div><div id=navbar class="collapse navbar-collapse"><ul class="nav navbar-nav"><li class=active><a href=#/ ui-sref=layout.home data-ng-bind=":: \'NAVBAR_TITLE_HOME\' | translate">Home</a></li><li><a href=#/favorites ui-sref=layout.favorites data-ng-bind=":: \'NAVBAR_TITLE_FAVORITES\' | translate">Favorites</a></li></ul><div class="navbar-form navbar-right"><div class=btn-group uib-dropdown><button id=dropdown-language type=button class="btn btn-default" uib-dropdown-toggle><span class="fa fa-language"></span> <span class="fa fa-caret-down"></span></button><ul class=dropdown-menu uib-dropdown-menu role=menu aria-labelledby=dropdown-language><li role=menuitem data-ng-repeat="language in navbar_top_vm.avaliableLanguages"><a href data-ng-bind=":: navbar_top_vm.mapLanguageTranslationByKey[language] | translate" data-ng-click=navbar_top_vm.switchLanguage(language)>{{language}}</a></li></ul></div></div></div></div></nav>'),t.put("app/components/order-list/order-list.html","<select data-ng-model=order_list_vm.orderBy class=form-control data-ng-change=order_list_vm.doOrderBy()><option value=\"\">{{:: 'ORDER_BY_LABEL' | translate}}</option><option value=Year>{{:: 'ORDER_BY_YEAR' | translate}}</option><option value=imdbRating>{{:: 'ORDER_BY_RATING' | translate}}</option><option value=Genre>{{:: 'ORDER_BY_GENRE' | translate}}</option></select>"),t.put("app/components/search-form/search-form.html",'<div class=search-form><form class=form-inline name=searchForm><div class=form-group><input type=text class=form-control placeholder="{{:: \'FORM_INPUT_SEARCH_NAME_PLACEHOLDER\' | translate}}" data-ng-model=search_form_vm.searchData.Title data-ng-change=search_form_vm.onChangeSearchData() required></div><div class=form-group><input type=text class=form-control placeholder="{{:: \'FORM_INPUT_SEARCH_YEAR_PLACEHOLDER\' | translate}}" data-ng-model=search_form_vm.searchData.Year data-ng-change=search_form_vm.onChangeSearchData()></div><div class=form-group><input type=text class=form-control , placeholder="{{:: \'FORM_INPUT_SEARCH_GENRE_PLACEHOLDER\' | translate}}" data-ng-model=search_form_vm.searchData.Genre data-ng-change=search_form_vm.onChangeSearchData()></div><div class=form-group><order-list data-list=search_form_vm.list></order-list></div><button type=submit class="btn btn-default" data-ng-bind=":: \'FORM_INPUT_SUBMIT\' | translate" data-ng-click=search_form_vm.doSearch() data-ng-disabled=searchForm.$invalid>Search</button></form></div>')}]);
//# sourceMappingURL=../maps/scripts/app-f2f99adff4.js.map
